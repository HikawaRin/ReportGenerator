# 行波管测试报告自动生成研究  

<!-- TOC -->

- [摘要](#摘要)
- [Abstract](#abstract)
- [第一章 绪论](#第一章-绪论)
  - [1.1 课题研究背景及意义](#11-课题研究背景及意义)
  - [1.2 国内外发展状况](#12-国内外发展状况)
  - [1.3 课题研究目的](#13-课题研究目的)
  - [1.4 本章小结](#14-本章小结)
- [第二章 相关技术研究](#第二章-相关技术研究)
  - [2.1 VSTO](#21-vsto)
    - [2.1.1 VSTO简介](#211-vsto简介)
    - [2.1.2 Word对象模型](#212-word对象模型)
  - [2.2 OpenXML](#22-openxml)
    - [2.2.1 OpenXML规范](#221-openxml规范)
    - [2.2.2 OpenXML SDK](#222-openxml-sdk)
  - [2.3 MySQL数据库技术](#23-mysql数据库技术)
  - [2.4 本章小结](#24-本章小结)
- [第三章](#第三章)
- [第四章](#第四章)
- [第五章 总结与展望](#第五章-总结与展望)
- [参考文献](#参考文献)

<!-- /TOC -->

## 摘要  

## Abstract  

## 第一章 绪论  

### 1.1 课题研究背景及意义  

行波管作为一种微波大功率放大器件已在航海、雷达、电子对抗及卫星通信等技术领域中。在行波管研究与生产过程中，为了掌握研发进度和行波管质量，需要对行波管的各项特征参数进行多次测试以及时发现并解决问题。[1]在行波管交付阶段，用户为了验证行波管的性能指标也需要对行波管进行大量测试。但是，行波管各项特性参数非常多，测试过程十分繁琐且需要测试人员同时掌握多种微波测试仪器的规范使用方法及各种微波测量方法。并且，行波管特性参数的非常多，目前特性参数测量方法的测试过程复杂，测试时间长，测试效率低，怎么快速有效地解决目前测试行波管特性参数中存在的问题，一直成为行波管研制过程中急需克服的挑战之一[2]。  

目前计算机技术广泛发展推动了测试仪器的数字化进程，测试仪器趋向数字化、软件化。不同仪器间的标准规范化使得用软件控制测试仪器自动完成测试过程，记录测试数据并生成测试报表的自动化测试系统的实现成为了现实。行波管自动测试系统在测试不同的参数时无需改变硬件连接方式，在启动测试时只需在操作面板上设置少量必需参数即可开始测量过程，测试过程快速有效，极高的提高了测试效率。  

报表往往是展示行波管测试结果最直观的表现形式，通过一份格式化的报表可以在研发和生产部门间有效地传递当前行波管所处的状态。通过测试报表可以大幅减少不同部门间的沟通成本，提高生产、研发效率。同时一支行波管的所有报表也体现了该管在一段时间内性能发生的变化，对于以后解决可能出现的问题提供了数据支撑，也是在大量生产时判断该管型是否老练足够的依据。可见测试报表是对行波管的整体总结，在行波管测试过程中具有重要地位。  

测试报表是测试结果输出的重要途经和主要方式，在整个测试过程中属于数据整理环节。由于行波管测试参数非常多，加之每个参数的测试数据也非常多，在此环节引入人为误差的可能性非常大。为了减小测试过程中可能产生的人为误差，节约人力成本，提高行波管测试效率有必要实现报表生成的自动化。而在行波管测试中，每个研究机构或生产厂家在长期的发展过程中已经形成了一套相对固定的内部报表格式，虽然测试内容相对固定，但表现形式十分多样化。为了减少这些机构将测试系统转换为自动化测试系统的代价，自动化测试系统的报表生成模块有必要具有适应不同报表模板的能力。由此可见进行行波管测试报告自动生成的研究可以节约大量人力，加速测试流程，对于推动行波管测试的自动化进程，加速行波管的发展进程具有重要意义。  

### 1.2 国内外发展状况  

微波测量仪器发展至今主要经历了四个阶段：第一阶段为模拟仪器阶段，仪器为电磁机械式结构，通过机械指针显示测量值的刻度；第二阶段为数字仪器阶段，在仪器内部将模拟信号转化为数字信号，相比于模拟仪器具有测试准确度高，响应速度快的优点[3]；第三阶段为智能仪器阶段，智能仪器诞生于1970年，通过与计算机配合完成测试任务，其测试速度与精度有了突破性的提高，现已广泛运用于实际生产活动中；第四阶段为虚拟仪器阶段，在总线技术出现后开始大规模使用[4]，虚拟仪器包含了智能仪器、总线和网络，由软件和硬件两部分组成，现在常用的总线标准有：GPIB、PXI、VXI、LAN和LXI等[5]。虚拟仪器通过总线和网络实现软件与硬件间的通信，将测试数据打包传输使得数据管理和报表生成成为了可能，在实际使用中可以根据需要编写软件实现特定测试功能的自动化测试平台。  

国外在商业报表领域发展很深入，21世纪以前已广泛采用水晶报表为代表的C/S模式软件，20世纪80年代，微软公司在Visual Basic中集成了水晶报表使得水晶报表逐渐成为当时的行业标准。进入21世纪后随着互联网以及数据库技术的发展，报表软件逐渐向B/S模式转化，用户可以不用安装客户端在浏览器上即可访问报表系统，具体体现为数据中心化和终端轻量化。国内外学者已对企业报表工具进行了大量研究，主要有三个方面的改进思路：第一，在设计报表时“所见即所得”，减少用户在报表设计和预览时的差异提高用户体验；第二，在设计报表时通过向导模式给用户推荐元素提高元素的复用率；第三，采用中间格式的文件提高报表生成的效率，减少用户制作报表模板的重复劳动。[6]  

而测试报告有其自身的特殊性，为了适应生产和技术的发展，测试项目可能会有增加，测试报告的格式也可能会有多次微调，而为了数据的连续性要求新的报告模板能兼容旧报告的数据。与商业报表不同，分析某一型号的行波管时需要多年积累的测试报告，如果直接使用商业报表将造成数据存储混乱，报表格式不统一，需要制作大量报表模板等可以预见的问题。国内行波管研发在自动化测试方面还处于起步阶段，自动化测试系统还未普及，目前大多数机构还处于从传统手工测试向自动化测试转换的过程中。由于报表格式复杂加之测试仪器数字化程度低，在数据处理方面大多采用人工读取数据，以“填表”的方式生成测试报告。现有的自动化测试系统的报表生产环节多借助于实现自动化测试的虚拟化仪器平台，如LabView。通过虚拟化仪器平台提供的MS Office COM接口制作报表。而虚拟化仪器平台提供的接口使用过程繁琐且功能单一难以实现进一步的定制化功能。  

### 1.3 课题研究目的  

本文  

### 1.4 本章小结  

## 第二章 相关技术研究  

### 2.1 VSTO  

#### 2.1.1 VSTO简介  

Visual Studio Tools for Office (VSTO)是一套包括Visual Studio add_in项目模板和允许MS Office 2003及更新版本的Office应用作为 .Net Framework Common Language Runtime(CLR)的宿主的运行时的开发工具，通过这套开发工具可以通过.NET运行环境拓展Office的功能。VSTO允许使用CLI兼容语言及Office应用提供的功能和用户接口编写Office应用拓展程序。  

在Visual Studio中可以获取帮助创建VSTO外接程序所需的工具。外接程序项目包含一个表示VSTO外接程序的自动生成的类。此类提供的属性和事件可用于访问主机应用程序的对象模型并在加载和关闭VSTO外接程序时运行代码。VSTO外接程序项目中还提供许多其他Visual Studio功能，例如Windows窗体和集成的调试器。通过使用Visual Studio中的Office开发人员工具生成VSTO外接程序时，将创建由Microsoft Office应用程序加载的托管的代码程序集。加载该程序集后，VSTO外接程序可以响应在MS Office中发生的事件。VSTO外接程序也可以通过主互操作程序集(Primary Interop Assembly, PIA)调用MS Office的对象模型，以便实现应用程序自动化和扩展应用程序，也可以使用 .NET Framework中的任何类来拓展需要的功能。  

当用户启动MS Office应用程序时，该应用程序使用部署清单和应用程序清单来查找并加载VSTO外接程序程序集的最新版本。下图显示了VSTO外接程序的基本体系结构。  
![Office07AddIn](office07addin.png)  

#### 2.1.2 Word对象模型  

Word提供了数百个可通过PIA与之交互的对象。这些对象严格遵循用户界面的层次结构。Application对象位于层次结构的顶部，此对象表示Word的当前实例。Application对象可以包含Document、Selection、Bookmark和Range对象。上述每个对象均具有很多属性和可用于操作对象和与之进行交互的方法。  

下图显示了Word对象模型层次结构中这些对象的一个视图。  
![WordObjectModel](wordobjectmodel.png)  

- 1.应用程序对象(Application)  
由于Word是一个单例应用只存在一个进程，而Application对象表示Word应用程序是所有其他对象的父级，其成员通常作为一个整体应用于Word。可以使用其属性和方法来控制Word环境。在VSTO外接程序项目中，可以通过Application类的Application字段来访问ThisAddIn对象。  
- 2.文档对象(Document)  
Document对象是Word编程的中心。它表示一个文档及其所有内容。当你打开文档或创建新文档时，将创建新的Document对象，并将其添加到Microsoft.Office.Interop.Word.Documents对象的Application集合。具有焦点的文档被称为活动文档。它由ActiveDocument对象的Application属性表示。
Visual Studio中的Office开发工具通过提供Document类型来扩展Document对象。此类型是一个托管项，使你可以访问Document对象的所有功能，并增添了其他事件以及添加托管控件的能力。  
- 3.Selection 对象  
Selection对象表示当前所选的区域。在Word用户界面中执行操作(如文本加粗)时，可以选择或突出显示文本，然后应用格式设置。文档中始终存在Selection对象。如果未选中任何内容，则它表示插入点。此外，选定内容可包含多个不相邻的文本块。  
- 4.Range对象  
Range对象表示文档中的相邻区域，并由起始字符位置和结束字符位置进行定义。可以在同一文档中定义多个Range对象。Range对象具有以下特性：  
  - 它可以只包含单独的插入点，也可包含一个文本范围或整个文档。  
  - 它包括非打印字符，如空格、制表符和段落标记。  
  - 它可以是当前选定内容所表示的区域，也可以表示不同于此内容的区域。  
  - 它在文档中不可见，这与选定内容不同，后者总是可见。  
  - 它不随文档一起保存，且仅在代码运行时才存在。  
  - 当在某个范围的末尾插入文本时，Word 会自动扩展该范围以包括插入的文本。  
- 5.Bookmark对象  
Bookmark对象表示文档中的相邻区域，同时具有起始位置和结束位置。你可以使用书签标记文档中的某个位置，也可将其作为文档中文本的容器。Bookmark对象可以包含插入点，也可以与整个文档一样大。  

除Word对象模型以外，通过Visual Studio还可访问可扩展Word对象模型中的一些对象的托管项和托管控件。主机项和主机控件的行为类似于它们扩展的Word对象，但它们还具有其他功能(如数据绑定功能)和额外事件。  

### 2.2 OpenXML  

#### 2.2.1 OpenXML规范  

OpenXML(Ecma Office Open XML)是一种针对字处理文档、电子表格和演示文档的国际性ECMA 376第二版和ISO/IEC 29500标准文件格式规范。现已被业界广泛接受并采用，在多个平台上有多种不同的实现。从技术的角度来看，OpenXML是一种开源的打包约定的规范。OpenXML文件格式是开放性标准并基于以下已知技术：ZIP和XML。OpenXML作为一个统一标准的开发平台为开发人员使用代码方式访问并操作文档内容及格式提供了极大的方便，只需针对OpenXML格式编写一套代码便可用于所有遵守OpenXML规范构建的文档。  

微软提出Open XML标准的目的是分离由MS Office应用程序创建的文档，以便其他应用程序可以独立于专有格式操作这些文档且不会丢失数据。  

#### 2.2.2 OpenXML SDK  

Open XML SDK 2.5 for Office是微软官方发布的操作OpenXML标准文档的开发工具包，该工具包基于System.IO.Packaging API构建而成，并提供强类型类来处理符合Office Open XML文件格式规范的文档。  

### 2.3 MySQL数据库技术  

### 2.4 本章小结  

## 第三章  

## 第四章  

## 第五章 总结与展望  

## 参考文献  

[1]李仕峰. 基于Labwindows/CVI的行波管自动测试系统设计与实现[D].电子科技大学,2018.  
[2]李镇远,冯进军,梁友焕.行波管中的微波测量技术[M].北京:国防工业出版社,2013,54.  
[3]陈宪琳. 基于Lab VIEW的内燃机空气滤清器试验系统[D].山东轻工业学院,2009.  
[4]张高俊. 基于虚拟仪器的远程路面结构性能测试系统的研究[D].长安大学,2010.  
[5]许征程. 简述虚拟网络实验室中的虚拟仪器[J].中国现代教育装备,2005(2):19-22.  
[6]钟子豪. 基于Web日志挖掘的报表系统设计与实现[D].华中科技大学,2016.  
[7]麦克格拉斯(McGrath).VSTO开发者指南[M].机械工业出版社,2008.  
[8]龚冠. 基于VSTO技术的公司报表系统的设计与应用[D].天津大学,2017.  
[9]程睿. 基于OpenXML的docx文档的创建和修改工具[D].大连理工大学,2013.  
[10]MicroSoft. 欢迎使用 Open XML SDK 2.5 for Office[EB/OL].<https://docs.microsoft.com/zh-cn/office/open-xml/open-xml-sdk>  
